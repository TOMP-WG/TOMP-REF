# Swagger generated server

## Overview
This server was generated by the [swagger-codegen](https://github.com/swagger-api/swagger-codegen) project. By using the
[OpenAPI-Spec](https://github.com/swagger-api/swagger-core/wiki) from a remote server, you can easily generate a server stub.  This
is an example of building a swagger-enabled Flask server.

This example uses the [Connexion](https://github.com/zalando/connexion) library on top of Flask.

## Requirements
Python 3.5.2+

## Usage
To run the server, please execute the following from the root directory:

```
pip3 install -r requirements.txt
python3 -m swagger_server
```

and open your browser to here:

```
http://localhost:8080/ui/
```

Your Swagger definition lives here:

```
http://localhost:8080/swagger.json
```

To launch the integration tests, use tox:
```
sudo pip install tox
tox
```

## Running with Docker

To run the server on a Docker container, please execute the following from the root directory:

```bash
# building the image
docker build -t tomp-oi .

# starting up a container
docker run -d -p 80:80 --rm --name tomp-oi tomp-oi
```

# Create application
## generate flask python server
1) Strip the authentication items out of the tomp.yaml file.

2) Strip all endpoints out of the yaml, except for the 'operator information' endpoint before generating the flask-server.  
OR  
Generate as is, extract all files in controllers, models and swagger directory AND run repair_swagger.ps1

## fix a bug in the python release of connexion (not taking into account the header fields)
locate parameter.py in your local app data:
    %AppData%\Local\Programs\Python\Python310\Lib\site-packages\connexion\decorators

insert at line 117 (just before # attempt to provide the request context to the function)
this snippet:

        for key, value in request.headers.items():
            skey = snake_and_shadow(key)
            if skey in arguments:
                kwargs[skey] = value
            else:
                logger.debug("Header '%s' not in function arguments", key)

## correct the code
In every endpoint in operator_information_controller.py, you have to replace the generated content with this line:  
```
return json_util.read_all_json('<item>.json')
```
where <item> is the requested item (f.x. regions, alerts, ..., everything between 'operator_'  and '_get' in the method name).